<!DOCTYPE html>
<html>

<head>
    <title>La rana Gustavo</title>
    <style>
        img {
            margin: 0.5px;
            border: dotted crimson;
            position: absolute;
        }

        #box {
            position: absolute;
        }
    </style>
</head>

<body>
    <img id="gus" src="rana.webp" width="15%">
    <div id="box"></div>

    <script>
        var contador = 0;
        var boxExists = false;
        var boxImg = document.createElement("img");
        var gameActive = true;

        function checkCollision() {
            if (gameActive) {
                var img = document.getElementById('gus');
                var box = document.getElementById('box');

                var imgRect = img.getBoundingClientRect();
                var boxRect = boxImg.getBoundingClientRect();

                var gusX = imgRect.left;
                var gusY = imgRect.top;

                var boxX = boxRect.left;
                var boxY = boxRect.top;

                if (
                    (gusX < boxX + boxImg.width) &&
                    (gusX + img.width > boxX) &&
                    (gusY < boxY + boxImg.height) &&
                    (gusY + img.height > boxY)
                ) {
                    gameActive = false;
                    alert('Â¡Rana cazada! Juego terminado.');
                }
            }
        }

        function moveImage(event) {
            if (gameActive) {
                var img = document.getElementById('gus');
                var box = document.getElementById('box');
                var screenWidth = window.innerWidth;
                var screenHeight = window.innerHeight;

                var mouseX = event.clientX;
                var mouseY = event.clientY;

                var moveDistance = 100;

                var newX = Math.random() * (screenWidth - img.width);
                var newY = Math.random() * (screenHeight - img.height);

                if (Math.abs(newX - mouseX) < moveDistance) {
                    if (newX < mouseX) {
                        newX += -moveDistance;
                    } else {
                        newX += moveDistance;
                    }
                }

                if (Math.abs(newY - mouseY) < moveDistance) {
                    if (newY < mouseY) {
                        newY += -moveDistance;
                    } else {
                        newY += moveDistance;
                    }
                }

                img.style.left = newX + 'px';
                img.style.top = newY + 'px';

                contador++;

                if (contador == 4) {
                    boxImg.src = "caja.png";
                    boxImg.width = "100";
                    box.appendChild(boxImg);
                    boxExists = true;
                }

                if (boxExists) {
                    checkCollision();
                }
            }

        }

        function moveBox(event) {
            if (gameActive) {
                var box = document.getElementById('box');
                var step = 20;

                switch (event.key) {
                    case 'w':
                        box.style.top = Math.max(0, box.offsetTop - step) + 'px';
                        break;
                    case 'a':
                        box.style.left = Math.max(0, box.offsetLeft - step) + 'px';
                        break;
                    case 's':
                        box.style.top = Math.min(window.innerHeight - box.offsetHeight, box.offsetTop + step) + 'px';
                        break;
                    case 'd':
                        box.style.left = Math.min(window.innerWidth - box.offsetWidth, box.offsetLeft + step) + 'px';
                        break;
                }
            }
        }

        var imgElement = document.getElementById('gus');
        var boxElement = document.getElementById('box');



        imgElement.addEventListener('mousemove', moveImage);
        document.addEventListener('keydown', moveBox);

        var tamano = 20;

        function aumentar() {
            console.log("hola");
            tamano = tamano + 20;
        }

        boxElement.addEventListener("click", () => {
            aumentar();
            boxImg.width = + tamano;
        });

    </script>
</body>

</html>